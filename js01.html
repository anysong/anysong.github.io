<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>拉勾网</title>
	<style>
		* {margin: 0;padding: 0;list-style: none;}
		li {position: relative;width: 200px;height: 200px;background: #ccc;left: 30%;top: 200px;overflow: hidden;float: left;margin-right: 20px;}
		span {position: absolute;top: 0;left: -200px;width: 100%;height: 100%;background: #09f;}
	</style>
	<script>
        function getStyle(obj,sName){
            return (obj.currentStyle || getComputedStyle(obj,false))[sName];
        }
        function move(obj,json,options){
            options=options || json;
            options.duration=options.duration || 500;
            options.easing=options.easing || 'linear';
            
            var start={};
            var dis={};
            for(var name in json){
                start[name]=parseFloat(getStyle(obj,name));
                dis[name]=json[name]-start[name];
            }
            var n=0;
            var count=Math.floor(options.duration/30);
            clearInterval(obj.timer);
            obj.timer=setInterval(function(){
                n++;
                for(var name in json){
                switch (options.easing){
                        case 'linear' :
                        var cur=start[name]+dis[name]*n/count;
                        break;
                        case 'ease-in' :
                        var a=n/count;
                        var cur=start[name]+dis[name]*a*a*a;
                        break;
                         case 'linear' :
                        var a=(1-n/count);
                        var cur=start[name]+dis[name]*(1-a*a*a);
                        break;
                }
                if(name=='opacity'){
                    obj.style.opacity=cur;
                }else{
                    obj.style[name]=cur+'px';
                }
                if(n==count){
                    clearInterval(obj.timer);
                }
                }
            },30)
        }
		window.onload=function(){
			var oUl=document.getElementById('ul1');
			
			var aLi=oUl.children;
			for(var i=0;i<aLi.length;i++){
				hover(aLi[i]);
			}
		}

		function hover(obj){
			var oDiv=document.getElementsByTagName('div')[0];
			var oSpan=obj.children[0];
			var w=oSpan.offsetWidth;
			var h=oSpan.offsetHeight;

			obj.onmouseenter=function(ev){
				var oEvent=ev || event;

				//var n=hoverDiv(obj,oEvent)

				var x=obj.offsetLeft+obj.offsetWidth/2-oEvent.clientX;
				var y=obj.offsetTop+obj.offsetHeight/2-oEvent.clientY;

				var n=Math.atan2(y,x)*180/Math.PI+180;
				console.log(n);
				oDiv.innerHTML=n;

				if(n>45&&n<135){
					//bottom
					oSpan.style.left='0';
					oSpan.style.top=h+'px';
					
				}else if(n>=135&&n<225){
					//left
					oSpan.style.left='-'+w+'px';
					oSpan.style.top='0';
				}else if(n>=225&&n<315){
					//top
					oSpan.style.top='-'+h+'px';
					oSpan.style.left='0';
				}else if(n>=315||n<=45){
					oSpan.style.left=w+'px';
					oSpan.style.top='0';
				}
				//alert(78);
				move(oSpan,{top:0,left:0})
			};
			obj.onmouseleave=function(ev){
				var oEvent=ev || event;

				var x=obj.offsetLeft+obj.offsetWidth/2-oEvent.clientX;
				var y=obj.offsetTop+obj.offsetHeight/2-oEvent.clientY;

				var n=Math.atan2(y,x)*180/Math.PI+180;
				console.log(n);
				oDiv.innerHTML=n;
				//alert(getStyle(oSpan,'left'));
				//move(oSpan,{left:100,top:100});
				if(n>45&&n<135){
					//bottom
					move(oSpan,{left:0,top:h})
					//oSpan.style.left='0';
					//oSpan.style.top=h+'px';
					
				}else if(n>=135&&n<225){
					//left
					move(oSpan,{left:-w,top:0})
					//oSpan.style.left='-'+w+'px';
					//oSpan.style.top='0';
				}else if(n>=225&&n<315){
					//top
					move(oSpan,{left:0,top:-h});
					//oSpan.style.top='-'+h+'px';
					//oSpan.style.left='0';
				}else if(n>=315||n<=45){
					move(oSpan,{left:w,top:0})
					//oSpan.style.left=w+'px';
					//oSpan.style.top='0';
				}
			}
		}
	</script>
</head>
<body>
	<ul id="ul1">
		<li><span>1111</span></li>
		<li><span>2222</span></li>
		<li><span>3333</span></li>
		<!-- <li><span></span></li> -->
	</ul>	
	<div></div>
</body>
</html>